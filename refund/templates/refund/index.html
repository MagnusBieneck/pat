{% extends 'base.html' %}
{% load i18n %}
{% load humanize %}

{% block content %}
<div class="col-12">
  <h3>{% trans 'Refund Overview' %}</h3>
  <table class="table table-striped table-hover table-responsive">
    <thead>
      <tr>
        <th scope="col" id="th_project">{% trans 'Project' %}</th>
        <th scope="col" id="th_department_leader">{% trans 'Department Leader' %}</th>
        <th scope="col" id="th_cost_centre">{% trans 'Cost Centre' %}</th>
        <th scope="col" id="th_total_amount">{% trans 'Total Amount' %}</th>
        {% if is_staff %}
        <th scope="col" id="th_requester">{% trans 'Requester' %}</th>
        {% endif %}
        <th scope="col" id="th_approved">{% trans 'Approved' %}</th>
        <th scope="col" id="th_processed">{% trans 'Processed' %}</th>
        <th scope="col"></th>
      </tr>
    </thead>
    <tbody>
  {% for row in data %}
      <tr>
        <td class="td-project">{{ row.project }}</td>
        <td class="td-department-leader">{{ row.department_leader }}</td>
        <td class="td-cost-centre">{{ row.cost_centre }}</td>
        <td class="td-total-amount">{{ row.amount|floatformat:2|intcomma }} â‚¬</td>
        {% if is_staff %}
        <td class="td-requester">{{ row.requester }}</td>
        {% endif %}
        <td class="td-approved">
          {% if row.is_approved %}
          <span class="badge badge-success" data-toggle="tooltip" data-placement="top" title="{% trans 'This request has been approved.' %}">{% trans 'Approved' %}</span>
          {% else %}
          <span class="badge badge-warning" data-toggle="tooltip" data-placement="top" title="{% trans 'This request has not yet been approved.' %}">{% trans 'Pending' %}</span>
          {% endif %}
        </td>
        <td class="td-processed">
          {% if row.is_processed %}
          <span class="badge badge-success" data-toggle="tooltip" data-placement="top" title="{% trans 'The refund has been performed.' %}">{% trans 'Processed' %}</span>
          {% else %}
          <span class="badge badge-warning" data-toggle="tooltip" data-placement="top" title="{% trans 'This request has not yet been processed.' %}">{% trans 'Pending' %}</span>
          {% endif %}
        </td>
        <td class="td-action">
          <a class="btn btn-primary btn-sm btn-edit" href="/refund/edit/{{ row.id }}" data-toggle="tooltip" data-placement="top" title="{% trans 'Approve and/or process this request.' %}">{% trans 'Edit' %}</a>
        </td>
      </tr>
  {% empty %}
      <tr>
        <td colspan="{% if is_staff %}8{% else %}7{% endif%}">{% trans 'As of now, no requests have been filed.' %}</td>
      </tr>
  {% endfor %}
    </tbody>
  </table>

  <a href="/refund/new/" class="btn btn-success">{% trans 'New request' %}</a>
</div>
<script type="text/javascript">
$(function () {
  $('[data-toggle="tooltip"]').tooltip()
})
</script>
{% endblock %}